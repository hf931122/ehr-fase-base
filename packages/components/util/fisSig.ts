import _0x44e9e3 from 'crypto-js'
import {JSEncrypt} from 'jsencrypt'
import config from './config'
import _0xf29f82 from './util'

const signature = {'encryptDate' (_0x16b9d2) { let _0x39b793 = this['getUrl'](_0x16b9d2); let _0xec5d8b=localStorage['getItem']('online##user'),_0x184c7c='';if(_0xec5d8b&&_0xec5d8b!='undefined'&&_0xec5d8b!='null'){_0x184c7c=JSON['parse'](_0xec5d8b)['userId'];}let _0x221c50=new Date()['getTime']()+'+'+_0x39b793+'+'+_0x184c7c;let _0x5b926b=eval('('+config['getValue']('VALID_ASSTOKEN')+')')||{};let _0x350344='';switch(_0x5b926b['use']){case'0':_0x350344='';break;case'1':_0x350344=this['encryptDES'](_0x221c50,this['getParam'](_0x5b926b),_0x5b926b);break;case'2':_0x350344=this['encryptAES'](_0x221c50,this['getParam'](_0x5b926b),_0x5b926b['key3'],_0x5b926b);break;case'3':_0x350344=this['encryptTDES'](_0x221c50,this['getParam'](_0x5b926b),_0x5b926b['key5'],_0x5b926b);break;case'4':_0x350344=this['encryptRSA'](_0x221c50,this['getParam'](_0x5b926b),_0x5b926b);break;case'10':_0x221c50=this['encryptTDES'](_0x221c50,_0x5b926b['key4'],_0x5b926b['key5']);_0x350344=_0xf29f82['encryptedRsa'](_0x221c50);}return _0x350344;},'getUrl'(_0x193f22){let _0x56b760=_0x193f22['split']('?')[0xc0463^0xc0463];let _0x19411a=_0x56b760['split'](/ehrc\/|ehrcfis\//);let _0x502b26=_0x19411a['length']==(0x909d6^0x909d4)?_0x19411a[0xb4900^0xb4901]:_0x19411a[0x51901^0x51901];if(_0x502b26['length']>(0x3202a^0x32016)){let _0x4820f4=_0x502b26['split']('/'),_0x2ab586=0xe8ee2^0xe8ee2;_0x4820f4['some']((_0x518354,_0x20a821)=>{if(_0x518354['length']>(0xd3f20^0xd3f39)){_0x2ab586=_0x20a821;return!![];}});if(_0x2ab586===(0xea434^0xea434)){_0x2ab586=_0x4820f4['length']-(0x24c34^0x24c36);}let _0x4e1b77=_0x4820f4['slice'](0xd913f^0xd913f,_0x2ab586);return _0x4e1b77['join']('/');}else{return _0x502b26;}},'encryptRSA'(_0x48abe2,_0x9a8e4,_0x5b155c){let _0x4bda63=new JSEncrypt();_0x4bda63['setPublicKey'](_0x9a8e4);_0x5b155c&&(_0x48abe2=this['encryptAES'](_0x48abe2,_0x5b155c['key2'],_0x5b155c['key3']));let _0x3d6a95=_0x4bda63['encrypt'](_0x48abe2);return _0x3d6a95;},'encryptRabbit'(_0x26fb1b,_0x221dd7){const _0x15e9c6=_0x44e9e3['enc']['Utf8']['parse'](_0x221dd7);let _0x52919f=_0x44e9e3['Rabbit']['encrypt'](_0x26fb1b,_0x15e9c6);return _0x52919f['toString']();},'decryprRabbit'(_0x37311d,_0x23a659){const _0x6fb885=_0x44e9e3['enc']['Utf8']['parse'](_0x23a659);let _0xd948e5=_0x44e9e3['Rabbit']['decrypt'](_0x37311d,_0x6fb885);let _0x4ef20b=_0xd948e5['toString'](_0x44e9e3['enc']['Utf8']);return _0x4ef20b;},'decryptByDES'(_0x19f49c,_0x498ede){const _0x3769f5=_0x44e9e3['enc']['Utf8']['parse'](_0x498ede);let _0x431134=_0x44e9e3['TripleDES']['decrypt'](_0x19f49c,_0x3769f5,{'mode':_0x44e9e3['mode']['ECB'],'padding':_0x44e9e3['pad']['Pkcs7']});let _0x4da9fc=_0x431134['toString'](_0x44e9e3['enc']['Utf8']);return _0x4da9fc;},'encryptDES'(_0x310a19,_0x2c2506,_0x2f5a17){const _0x54afaf=_0x44e9e3['enc']['Utf8']['parse'](_0x2c2506);_0x2f5a17&&(_0x310a19=this['encryptRSA'](_0x310a19,_0x2f5a17['key6']));let _0x3b29cb=_0x44e9e3['DES']['encrypt'](_0x310a19,_0x54afaf,{'mode':_0x44e9e3['mode']['ECB'],'padding':_0x44e9e3['pad']['Pkcs7']});return _0x3b29cb['toString']();},'encryptTDES'(_0x21188e,_0x172b44,_0x1a6495,_0x22188a){const _0x3a1a17=_0x44e9e3['enc']['Utf8']['parse'](_0x172b44);let _0x4a6114=_0x44e9e3['enc']['Utf8']['parse'](_0x1a6495);_0x22188a&&(_0x21188e=_0xf29f82['encryptedRsa'](_0x21188e));let _0x10db96=_0x44e9e3['TripleDES']['encrypt'](_0x21188e,_0x3a1a17,{'iv':_0x4a6114,'mode':_0x44e9e3['mode']['CBC'],'padding':_0x44e9e3['pad']['Pkcs7']});return _0x10db96['toString']();},'encryptAES'(_0x19d736,_0x50f1e7,_0x2c73b9,_0x419dcc){let _0x290ec7=_0x44e9e3['enc']['Utf8']['parse'](_0x50f1e7);let _0x5b6c6d=_0x44e9e3['enc']['Utf8']['parse'](_0x2c73b9);let _0x5d3426=JSON['stringify'](_0x19d736);_0x419dcc&&(_0x5d3426=this['encryptRSA'](_0x19d736,_0x419dcc['key6']));let _0x4c806d=_0x44e9e3['AES']['encrypt'](_0x5d3426,_0x290ec7,{'iv':_0x5b6c6d,'mode':_0x44e9e3['mode']['CBC'],'padding':_0x44e9e3['pad']['Pkcs7']});return _0x4c806d['ciphertext']['toString']();},'decryptByAES'(_0x473f1a,_0xedb319,_0x5a969b){let _0x439efc=_0x44e9e3['enc']['Utf8']['parse'](_0xedb319);let _0x5863a6=_0x44e9e3['enc']['Utf8']['parse'](_0x5a969b);let _0x5dfec5=_0x44e9e3['AES']['decrypt'](_0x44e9e3['format']['Hex']['parse'](_0x473f1a),_0x439efc,{'iv':_0x5863a6,'mode':_0x44e9e3['mode']['CBC'],'padding':_0x44e9e3['pad']['Pkcs7']});return _0x44e9e3['enc']['Utf8']['stringify'](_0x5dfec5);},'encryptAESEBC'(_0x26c203,_0x4fd32d){let _0x2c9b7e=_0x44e9e3['enc']['Utf8']['parse'](_0x4fd32d);let _0x51548e=_0x44e9e3['enc']['Utf8']['parse'](_0x26c203);let _0x297c8f=_0x44e9e3['AES']['encrypt'](_0x51548e,_0x2c9b7e,{'mode':_0x44e9e3['mode']['ECB'],'padding':_0x44e9e3['pad']['Pkcs7']});return _0x297c8f['toString']();},'getParam'(_0x4f64a3){let _0xacf56e='';switch(_0x4f64a3['use']){case'1':_0xacf56e=_0x4f64a3['key'];break;case'2':_0xacf56e=_0x4f64a3['key2'];break;case'3':_0xacf56e=_0x4f64a3['key4'];break;case'4':_0xacf56e=_0x4f64a3['key6'];break;}return _0xacf56e;}}

export default signature
